<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The Automated Tracker</title>
  <link rel="stylesheet" href="assets/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script defer src="assets/main.js"></script>
</head>
<body>
  <div class="toast hide" id="toast">Database Ready âœ…</div>

  <div class="wrap">
    <h1>The Automated Tracker</h1>

    <!-- FORM -->
    <div class="card">
      <form id="offerForm">
        <div class="grid">

          <!-- Rate Version -->
          <div class="col-6">
            <label>Rate Version</label>
            <select id="rateVersion"></select>
            <div id="rateVersionNewWrap" class="hide" style="margin-top:8px;">
              <input type="text" id="rateVersionNew" placeholder="Enter New Rate Version">
              <label class="row warning">
                <input type="checkbox" id="rateVersionSavePerm" />
                <span>Save this new Rate Version for future offers.</span>
              </label>
            </div>
          </div>

          <!-- Fiber -->
          <div class="col-2">
            <label class="inline-checkbox"><input type="checkbox" id="fiberCheck"> Fiber</label>
          </div>

          <!-- Campaign -->
          <div class="col-4">
            <label>Campaign</label>
            <input type="text" id="campaign" placeholder="General Offer" required>
          </div>

          <!-- Offer Summary -->
          <div class="col-12">
            <label>Offer Summary</label>
            <input type="text" id="offer" placeholder="100 Mbps for $29.95/mo. for 12 mos. w/ Auto Pay Paperless Billing.">
          </div>

          <!-- Speeds & Pricing -->
          <div class="col-3"><label>Download Speed</label><input type="text" id="down" placeholder="100 Mbps"></div>
          <div class="col-3"><label>Upload Speed</label><input type="text" id="up" placeholder="10 Mbps"></div>
          <div class="col-3"><label>Promo Price</label><input type="text" id="promo" placeholder="$29.95"></div>
          <div class="col-3"><label>Term (months)</label><input type="text" id="term" placeholder="12"></div>

          <!-- Gift Card -->
          <div class="col-4">
            <label class="inline-checkbox">
              <input type="checkbox" id="gcCheck"> Gift Card
            </label>
            <div class="row">
              <input type="text" id="gcAmt" class="hide" value="$100" style="max-width:140px;">
            </div>
          </div>

          <!-- Step-Up Pricing -->
          <div class="col-4">
            <label class="inline-checkbox">
              <input type="checkbox" id="stepCheck"> Step-Up Pricing
            </label>
            <div class="row">
              <input type="text" id="suTerm" class="hide" placeholder="7â€“12" style="max-width:160px;">
              <input type="text" id="suPrice" class="hide" placeholder="$59.95" style="max-width:120px;">
            </div>
          </div>

          <div class="col-4"><label>Reg Rate</label><input type="text" id="reg" placeholder="$75â€“$90"></div>

          <!-- Equipment & Mentions -->
          <div class="col-4">
            <label class="inline-checkbox"><input type="checkbox" id="equipIncluded"> Equipment Included</label>
          </div>
          <div class="col-4">
            <label class="inline-checkbox"><input type="checkbox" id="eeroMentioned"> eero/Plume Mentioned</label>
          </div>

          <!-- Expiration & Unlimited -->
          <div class="col-4">
            <label>Offer Expiration</label>
            <input type="date" id="expires">
          </div>
          <div class="col-4">
            <label class="inline-checkbox"><input type="checkbox" id="unlimitedCheck" checked> Unlimited Data</label>
          </div>

          <div class="col-12 hr"></div>

          <!-- Disclaimers -->
          <div class="col-6">
            <label>Short Disclaimer</label>
            <textarea id="shortDisc" placeholder="Click 'Generate Disclaimers'"></textarea>
          </div>
          <div class="col-6">
            <label>Long Disclaimer</label>
            <textarea id="longDisc" placeholder="Click 'Generate Disclaimers'"></textarea>
          </div>
          <div class="col-12" style="display:flex; justify-content:flex-end; gap:8px;">
            <button type="button" class="btn ghost" id="genBaseBtn">ðŸª„ Generate Disclaimers</button>
          </div>

          <div class="col-12 hr"></div>

          <!-- Hidden Status + Automated Tracker + Notes -->
          <input type="hidden" id="status" value="Not Started">
          <div class="col-6 hide">
            <label>Automated Tracker</label>
            <input type="text" id="automatedTracker" readonly value="Automated_Tracker_(101525)">
            <div class="hint">Auto-filled as Automated_Tracker_(MMDDYY)</div>
          </div>
          <div class="col-6">
            <label>Notes (optional)</label>
            <input type="text" id="notes" placeholder="Optional notes or internal comments.">
          </div>

          <div class="col-12" style="display:flex; justify-content:flex-end; gap:8px;">
            <button type="button" class="btn ghost" id="resetFormBtn">Reset</button>
            <button type="submit" class="btn" id="submitBtn">Save Offer</button>
          </div>
        </div>
        <input type="hidden" id="editId" value="">
      </form>
    </div>

    <!-- Offer Summary Preview -->
    <div id="offerPreviewCard" class="card">
      <div id="offerPreviewHeader">Offer Summary Preview</div>
      <div id="offerPreviewBody">
        <em>Updates automatically as you edit fields.</em><br><br>
        <div>
          <strong>Rate Version:</strong> <span id="pRate">â€”</span><br>
          <strong>Type:</strong> <span id="pType">â€”</span><br>
          <strong>Campaign:</strong> <span id="pCampaign">â€”</span><br>
          <strong>Offer:</strong> <span id="pOffer">â€”</span><br>
          <strong>Speeds:</strong> <span id="pSpeeds">â€”</span><br>
          <strong>Promo:</strong> <span id="pPromo">â€”</span> | <strong>Term:</strong> <span id="pTerm">â€”</span><br>
          <strong>Step-Up:</strong> <span id="pStep">â€”</span><br>
          <strong>Reg Rate:</strong> <span id="pReg">â€”</span><br>
          <strong>Gift Card:</strong> <span id="pGift">â€”</span><br>
          <strong>Equipment Included:</strong> <span id="pEquip">â€”</span><br>
          <strong>eero/Plume Mentioned:</strong> <span id="pEero">â€”</span><br>
          <strong>Expires:</strong> <span id="pExp">â€”</span> | <strong>Unlimited Data:</strong> <span id="pUnlimited">â€”</span><br>
        </div>
      </div>
    </div>

    <!-- Offers Table -->
    <div class="card">
      <div class="row" style="justify-content: space-between; align-items:center;">
        <h2 style="margin:0;">Saved Offers</h2>
        <div class="row">
          <button class="btn ghost" id="exportCsvBtn">Export CSV</button>
          <button class="btn" id="exportXlsxBtn">Export XLSX</button>
        </div>
      </div>
      <div class="hr"></div>
      <table id="offersTable">
        <thead>
          <tr>
            <th>Thumbnail</th>
            <th>Rate Version</th>
            <th>Type</th>
            <th>Campaign</th>
            <th>Offer</th>
            <th>Promo</th>
            <th>Term</th>
            <th>Reg Rate</th>
            <th>Gift Card</th>
            <th>Expires</th>
            <th>Status</th>
            <th style="text-align:right;">Actions</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <footer class="row" style="justify-content: space-between;">
        <span class="hint">Filename on export: <code>Automated_Tracker_(MMDDYY)</code></span>
        <button class="btn ghost" id="clearAllBtn" title="Delete all saved offers">ðŸ§¹ Clear All Offers</button>
      </footer>
    </div>
  </div>

  <!-- Disclaimer Modal -->
  <div id="discModal" class="modal hide" role="dialog" aria-modal="true" aria-labelledby="discTitle">
    <div class="modal-overlay"></div>
    <div class="modal-card animate-in">
      <div class="modal-header">
        <h3 id="discTitle">ðŸª„ Generated Disclaimers Preview</h3>
        <button class="btn ghost" id="closeModalBtn" aria-label="Close">Close</button>
      </div>
      <div class="modal-body">
        <div class="modal-block">
          <h4>Short Disclaimer</h4>
          <pre id="previewShort"></pre>
        </div>
        <div class="modal-block">
          <h4>Long Disclaimer</h4>
          <pre id="previewLong"></pre>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn ghost" id="cancelDiscBtn">Cancel</button>
        <button class="btn" id="applyDiscBtn">Apply</button>
      </div>
    </div>
  </div>
</body>
</html>
