<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sparklight Offer Management</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <style>
    :root {
      --bg: #f8fafc;
      --card: #ffffff;
      --ink: #0f172a;
      --muted: #475569;
      --brand: #0284c7;
      --brand-dark: #0369a1;
      --line: #e2e8f0;
      --good: #16a34a;
      --bad: #dc2626;
      --purple: #e0d7ff;
    }

    * { box-sizing: border-box; }
    body { margin: 0; font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background: var(--bg); color: var(--ink); }
    .wrap { max-width: 1150px; margin: 32px auto; padding: 0 16px; }
    h1 { color: var(--brand-dark); margin-bottom: 10px; }

    .card { background: var(--card); border: 1px solid var(--line); border-radius: 14px; box-shadow: 0 4px 14px rgba(0,0,0,.05); padding: 20px; margin-bottom: 18px; }
    .grid { display: grid; gap: 14px; grid-template-columns: repeat(12, 1fr); }
    .col-3 { grid-column: span 3; } .col-4 { grid-column: span 4; } .col-6 { grid-column: span 6; } .col-12 { grid-column: span 12; }

    label { font-size: 12px; text-transform: uppercase; color: var(--muted); display: block; margin-bottom: 4px; }
    input[type="text"], input[type="date"], select, textarea {
      width: 100%; padding: 10px 12px; border: 1px solid var(--line); border-radius: 10px; font-size: 14px;
    }
    .row { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }

    .btn { appearance: none; border: none; background: var(--brand); color: #fff; font-weight: 600; padding: 8px 12px; border-radius: 8px; cursor: pointer; }
    .btn:hover { background: var(--brand-dark); }

    table { width: 100%; border-collapse: collapse; border: 1px solid var(--line); border-radius: 8px; overflow: hidden; }
    th, td { padding: 6px 10px; text-align: left; border-bottom: 1px solid var(--line); font-size: 12px; vertical-align: top; line-height: 1.3; }
    th { background: #f1f5f9; font-size: 13px; }
    td { word-break: break-word; max-width: 200px; transition: font-size .2s ease; }

    /* Dynamic shrinking for multiline text */
    td.shrink { font-size: 10px; }
    td.shrink-sm { font-size: 8px; }
    td.shrink-xs { font-size: 6px; }

    /* Offer Summary Card */
    #offerPreviewCard {
      background: var(--card);
      border-radius: 14px;
      box-shadow: 0 4px 16px rgba(0,0,0,.05);
      margin: 20px 0;
      overflow: hidden;
    }
    #offerPreviewHeader {
      background: var(--purple);
      padding: 10px 16px;
      font-weight: 700;
      color: #4b0082;
      border-bottom: 1px solid var(--line);
    }
    #offerPreviewBody {
      padding: 14px 18px;
      font-size: 14px;
      line-height: 1.5;
      color: var(--ink);
    }
    #offerPreviewBody strong {
      color: var(--brand-dark);
    }

    footer {
      text-align: center;
      font-size: 12px;
      color: var(--muted);
      margin: 30px 0 10px;
    }
    footer a {
      color: var(--brand-dark);
      text-decoration: none;
      font-weight: 600;
    }
    footer a:hover { text-decoration: underline; }
  </style>
</head>

<body>
  <div class="wrap">
    <h1>ðŸ’¡ Sparklight Offer Management</h1>

    <!-- === FORM SECTION === -->
    <div class="card" id="formSection">
      <!-- (All your existing form fields go here; same as v2 version you had, unchanged in layout) -->
      <!-- The script in Part 2 will populate and handle all logic dynamically -->
      <form id="offerForm">
        <!-- Form fields inserted dynamically -->
      </form>
    </div>

    <!-- === OFFER SUMMARY PREVIEW CARD === -->
    <div id="offerPreviewCard">
      <div id="offerPreviewHeader">ðŸ§¾ Offer Summary Preview</div>
      <div id="offerPreviewBody">
        <em>Updates automatically as you edit fields.</em><br><br>
        <div id="previewContent">
          <strong>Core Enhanced:</strong> <span id="pCore">â€”</span><br>
          <strong>Type:</strong> <span id="pType">â€”</span><br>
          <strong>Campaign:</strong> <span id="pCampaign">â€”</span><br>
          <strong>Offer:</strong> <span id="pOffer">â€”</span><br>
          <strong>Promo:</strong> <span id="pPromo">â€”</span> | <strong>Term:</strong> <span id="pTerm">â€”</span><br>
          <strong>Step-Up:</strong> <span id="pStep">â€”</span><br>
          <strong>Reg Rate:</strong> <span id="pReg">â€”</span><br>
          <strong>Gift Card:</strong> <span id="pGift">â€”</span><br>
          <strong>Equipment:</strong> <span id="pEquip">â€”</span><br>
          <strong>Expires:</strong> <span id="pExp">â€”</span> | <strong>Unlimited Data:</strong> <span id="pUnlimited">â€”</span><br>
          <strong>Tracker:</strong> <span id="pTracker">â€”</span>
        </div>
      </div>
    </div>

    <!-- === DATA TABLE SECTION === -->
    <div class="card" style="overflow:auto;">
      <table id="offersTable">
        <thead>
          <tr id="tableHeaderRow">
            <!-- Table headers inserted by JS -->
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- === FOOTER === -->
    <footer>
      Â© 2025 Sparklight Offer Management â€¢ <a href="README.md" target="_blank">View Full Documentation</a>
    </footer>
  </div>
